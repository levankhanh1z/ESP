-- Các biến cấu hình
local espParts = {"Stone"}  -- Danh sách tên các phần tử muốn hiển thị ESP
ocal espTransparency = 0.5  -- Độ trong suốt của hộp ESP

-- Các biến cho thông tin khoảng cách
local player = game.Players.LocalPlayer

-- Hàm kiểm tra xem một giá trị có tồn tại trong bảng hay không
function FindInTable(tbl, value)
    for _, v in ipairs(tbl) do
        if v == value then
            return true
        end
    end
    return false
end

-- Hàm tạo hiệu ứng ESP cho một phần tử
function CreateESP(part, distance)
    local espAdornment = Instance.new("BoxHandleAdornment")
    espAdornment.Name = part.Name:lower().."_PESP"
    espAdornment.Parent = part
    espAdornment.Adornee = part
    espAdornment.AlwaysOnTop = true
    espAdornment.ZIndex = 0
    espAdornment.Size = part.Size
    espAdornment.Transparency = espTransparency
    espAdornment.Color = BrickColor.new("Lime green").Color
end

-- Hàm được gọi khi một phần tử mới được thêm vào
function partAdded(part)
    if #espParts > 0 and FindInTable(espParts, part.Name:lower()) then
        local character = player.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            local playerPosition = character.HumanoidRootPart.Position
            local partPosition = part.Position
            local distance = (partPosition - playerPosition).magnitude
            CreateESP(part, distance)
        end
    end
end

-- Lắng nghe sự kiện thêm phần tử mới trong game.Workspace.Mine
game.Workspace.Mine.DescendantAdded:Connect(function(descendant)
    if descendant:IsA("BasePart") then
        partAdded(descendant)
    end
end)

-- Lắng nghe sự kiện khi phần tử trong game.Workspace.Mine thay đổi
game.Workspace.Mine.DescendantRemoving:Connect(function(descendant)
    if descendant:IsA("BasePart") then
        -- Xóa ESP khi phần tử bị loại bỏ
        local espAdornment = descendant:FindFirstChild(descendant.Name:lower().."_PESP")
        if espAdornment then
            espAdornment:Destroy()
        end
    end
end)
    end
end)
